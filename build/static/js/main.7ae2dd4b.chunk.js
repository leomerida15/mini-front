(this["webpackJsonpadmin-ts"]=this["webpackJsonpadmin-ts"]||[]).push([[0],{505:function(e,t,a){},507:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(86),s=a.n(r),c=a(65),o=a.n(c),i=a(95),u=a(183),l=a.n(u);o.a.defaults.baseURL="https://sabaneta.miproyectoparticipativo.com/v1",o.a.defaults.headers.common.authorization=localStorage.getItem("token"),o.a.defaults.headers["Content-Type"]="application/json",o.a.interceptors.response.use((function(e){return e.data&&e.data.token&&localStorage.setItem("token",e.data.token),e}));var d=new l.a({max:10});Object(i.a)({axios:o.a,cache:d});var j=o.a,b=a(85),m=a(26),p=a(1),O=function(e){var t=e.children,a=Object(m.e)();return localStorage.getItem("token")?Object(p.jsx)(p.Fragment,{children:t}):["/","/pass"].includes(a.pathname)?Object(p.jsx)(p.Fragment,{}):Object(p.jsx)(m.a,{to:"/",state:{from:a},replace:!0})},f=function(e){var t=e.children,a=Object(m.e)();return localStorage.getItem("token")?a.pathname.includes("dash")?Object(p.jsx)(p.Fragment,{}):Object(p.jsx)(m.a,{to:"/dash",state:{from:a},replace:!0}):Object(p.jsx)(p.Fragment,{children:t})},h=a(23),x=a.n(h),v=a(35),g=a(5),w=a(30),y=a(3),C=a(8),E=a(46),k=a(669),I=a(666),S=a(686),N=a(687),P=a(680),F=a(647),q=a(648),A=a(684),M=a(310),T=a.n(M),L=a(313),R=a.n(L),z=a(312),U=a.n(z),D=a(657),B=a(649),V=a(637),$=a(308),K=a.n($),G=a(25),X=a(683),_=a(73),J=a.n(_),H=a(187),Q=a.n(H),W=a(299),Y=a.n(W)()(Q.a),Z=Y,ee=function(e,t){var a=e.response,n=a?a.data.message:e.message?e.message:"";t?Y.fire(Object(w.a)({text:n},t)):Y.fire({title:"Error",text:n,icon:"error"})},te=a(664),ae=a(660),ne=a(632),re=a(682),se=a(104),ce=a(134),oe=a(321),ie=a(663),ue=a(659),le=a(678),de=a(675),je=a(304),be=a.n(je),me=a(303),pe=a.n(me),Oe=a(653),fe=a(654),he=a(638),xe=a(640),ve=a(639),ge=a(681),we=a(658),ye=a(652),Ce=a(641),Ee=a(644),ke=function(e){var t=e.fromInput,a=e.Action,r=e.schema,s=e.sx,c=e.conten,o=e.ButtonClass,i=e.buttonText,u=Object(se.e)(r?{resolver:Object(oe.a)(r)}:{}),l=u.control,d=u.handleSubmit,j=u.formState.errors,b=function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a(t)}catch(n){console.error(n)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(e){switch(e.type){case"file":return function(t){var a=t.field,n=a.onChange,r=a.value,s=e.name,c=e.InputProps,o=e.label,i=e.autoFocus;return e.value&&(r=e.value),Object(p.jsx)(de.a,{onChange:n,defaultValue:r,label:o,error:!!j[s],helperText:j[s]&&j[s].message,InputProps:c||"",autoFocus:null!==i&&void 0!==i&&i,type:"file"})};case"select":return function(t){var a=t.field,n=a.onChange,r=a.value,s=e.currencies,c=e.name,o=e.label,i=e.autoFocus;e.value&&(r=e.value);return Object(p.jsxs)(le.a,{children:[Object(p.jsx)(ue.a,{id:"demo-simple-select-label",children:o}),Object(p.jsx)(Oe.a,{error:!!j[c],autoFocus:null!==i&&void 0!==i&&i,defaultValue:r,label:o,onChange:function(e){return n(e)},children:s?s.map((function(e){var t=e.name;return Object(p.jsx)(re.a,{value:t,children:t},t)})):[]})]})};case"select-multiple":return function(t){var a=t.field,r=a.onChange,s=(a.value,e.currencies),c=e.name,o=e.label,i=e.autoFocus,u=e.checkItems;e.value&&e.value;var l=Object(n.useState)(u||[]),d=Object(g.a)(l,2),b=d[0],m=d[1];return Object(p.jsxs)(le.a,{error:!!j[c],sx:{m:1},children:[Object(p.jsx)(ue.a,{id:"label-".concat(o),children:o}),Object(p.jsx)(Oe.a,{labelId:"label-".concat(o),id:c,multiple:!0,value:b,onChange:function(e){var t=e.target.value;m("string"===typeof t?t.split(","):t),r(e)},input:Object(p.jsx)(ie.a,{label:o}),renderValue:function(e){return e.join(", ")},autoFocus:null!==i&&void 0!==i&&i,children:s?s.map((function(e){var t=e.name;return Object(p.jsxs)(re.a,{value:t,children:[Object(p.jsx)(fe.a,{checked:b.includes(t)}),Object(p.jsx)(V.a,{primary:t})]},t)})):[]}),Object(p.jsx)(ge.a,{error:!!j[c],id:c,children:j[c]&&j[c].message})]})};case"text":return function(t){var a=t.field,n=a.onChange,r=a.value,s=e.name,c=e.InputProps,o=e.label,i=e.autoFocus;return e.value&&(r=e.value),Object(p.jsx)(de.a,{onChange:n,defaultValue:r,label:o,error:!!j[s],helperText:j[s]&&j[s].message,InputProps:c||"",autoFocus:null!==i&&void 0!==i&&i})};case"email":return function(t){var a=t.field,n=a.onChange,r=a.value,s=e.name,c=e.InputProps,o=e.label,i=e.autoFocus;return e.value&&(r=e.value),Object(p.jsx)(de.a,{onChange:n,defaultValue:r,label:o,type:"email",error:!!j[s],helperText:j[s]&&j[s].message,InputProps:c||"",autoFocus:null!==i&&void 0!==i&&i})};case"password-see":return function(t){var a=t.field,r=a.onChange,s=a.value,c=e.name,o=e.label,i=e.autoFocus;e.value&&(s=e.value);var u,l=Object(n.useState)({password:s,showPassword:!1}),d=Object(g.a)(l,2),b=d[0],m=d[1];return Object(p.jsxs)(le.a,{sx:{m:1},variant:"outlined",error:!!j[c],children:[Object(p.jsx)(ue.a,{htmlFor:c,children:o}),Object(p.jsx)(ie.a,{id:c,type:b.showPassword?"text":"password",defaultValue:b.password,onChange:(u="password",function(e){m(Object(w.a)(Object(w.a)({},b),{},Object(y.a)({},u,e.target.value))),r(e)}),endAdornment:Object(p.jsx)(X.a,{position:"end",children:Object(p.jsx)(A.a,{"aria-label":"toggle password visibility",onClick:function(){m(Object(w.a)(Object(w.a)({},b),{},{showPassword:!b.showPassword}))},onMouseDown:function(e){return e.preventDefault()},edge:"end",children:b.showPassword?Object(p.jsx)(pe.a,{}):Object(p.jsx)(be.a,{})})}),label:o,autoFocus:null!==i&&void 0!==i&&i}),Object(p.jsx)(ge.a,{id:c,children:j[c]&&j[c].message})]})};case"password":return function(t){var a=t.field,n=a.onChange,r=a.value,s=e.name,c=e.InputProps,o=e.label,i=e.autoFocus;return e.value&&(r=e.value),Object(p.jsx)(de.a,{onChange:n,defaultValue:r,label:o,type:"password",error:!!j[s],InputProps:c||"",autoFocus:null!==i&&void 0!==i&&i})};case"time-date":return function(t){var a=t.field,n=a.onChange,r=a.value,s=e.name,c=e.timeConfig,o=c.inputFormat,i=c.typeTime,u=e.label;e.value&&(r=e.value);var l=function(e){n({target:{name:s,value:e}})};return Object(p.jsx)(he.b,{locale:"es",dateAdapter:ve.a,children:Object(p.jsx)(xe.a,{spacing:3,children:function(){switch(i){case"Desktop":return Object(p.jsx)(Ce.a,{label:u,inputFormat:null!==o&&void 0!==o?o:"MM/dd/yyyy",value:r,onChange:l,renderInput:function(e){return Object(p.jsx)(de.a,Object(w.a)({},e))}});case"Mobile":return Object(p.jsx)(Ee.a,{label:u,inputFormat:null!==o&&void 0!==o?o:"MM/dd/yyyy",value:r,onChange:l,renderInput:function(e){return Object(p.jsx)(de.a,Object(w.a)({},e))}});case"Time":return Object(p.jsx)(we.a,{label:u,value:r,onChange:l,renderInput:function(e){return Object(p.jsx)(de.a,Object(w.a)({},e))}});case"Date":return Object(p.jsx)(ye.a,{label:u,value:r,onChange:l,renderInput:function(e){return Object(p.jsx)(de.a,Object(w.a)({},e))}})}}()})})}}};return Object(p.jsxs)(p.Fragment,{children:[" ",Object(p.jsxs)(k.a,{onSubmit:d(b),component:"form",sx:s||{"& > :not(style)":{m:1}},className:c||"ed-grid",noValidate:!0,autoComplete:"off",children:[t.map((function(e,t){var a=e.name,n=e.rules;return Object(p.jsx)(se.a,{name:a,control:l,rules:n,render:e.render?e.render:m(e)},t)})),Object(p.jsx)(ce.a,{type:"submit",className:o||"",variant:"contained",children:i||"Submit"})]})]})},Ie={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",border:"2px solid #fff",borderRadius:2,boxShadow:24,px:4,py:4},Se=function(e){var t=e.open,a=e.onClose,n=e.form,r=e.children;return Object(p.jsx)("div",{children:Object(p.jsx)(ae.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:t,onClose:a,closeAfterTransition:!0,BackdropComponent:te.a,BackdropProps:{timeout:500},children:Object(p.jsx)(ne.a,{in:t,children:Object(p.jsxs)(k.a,{sx:Ie,children:[" ",r||"",n?Object(p.jsx)(ke,Object(w.a)({},n)):""]})})})})},Ne=a(307),Pe=a.n(Ne),Fe=a(665),qe=a(685),Ae=function(e){var t=e.children;return e.load?Object(p.jsx)(k.a,{sx:{display:"flex"},children:Object(p.jsxs)("div",{className:"s-to-center s-py-4",children:[" ",Object(p.jsx)(qe.a,{})]})}):Object(p.jsx)(p.Fragment,{children:t})},Me=function(e){return Object(p.jsx)(ke,Object(w.a)({},e))};Object(G.c)({mixed:{required:"Este campo es requerido"},string:{min:"El minimo de caracteres es de ${min}",max:"El maximo de caracteres es de ${max}",email:"El correo esta mal formateado"}});var Te=G.b().shape({password:G.d().min(8).max(12).required(),confirPass:G.d().min(8).max(12).required()}).required(),Le=function(){var e=Object(n.useState)(!1),t=Object(g.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)(!1),c=Object(g.a)(s,2),o=c[0],i=c[1],u=function(){var e=Object(v.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(!0),j.defaults.headers.common.authorization=localStorage.getItem("token"),e.next=5,j.post("/auth/users/newPass",t);case 5:n=e.sent,Z.fire({title:n.data.message,icon:"success"}),setTimeout((function(){i(!1),r(!a)}),1e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),i(!1),ee(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),l=[{type:"password-see",name:"password",label:"Contrase\xf1a",rules:function(e){return{required:!0}}},{type:"password",name:"confirPass",label:"Repetir Contrase\xf1a",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}}];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(A.a,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(){return r(!a)},color:"inherit",children:Object(p.jsx)(Fe.a,{title:"Cambiar Contrase\xf1a",children:Object(p.jsx)(Pe.a,{})})}),Object(p.jsxs)(Se,{onClose:function(){return r(!a)},open:a,children:[Object(p.jsx)("h2",{children:"Nueva Contrase\xf1a"}),Object(p.jsx)(Ae,{load:o,children:Object(p.jsx)(Me,{buttonText:"Cambiar Contrase\xf1a",Action:u,schema:Te,fromInput:l})})]})]})},Re=a(309),ze=a.n(Re),Ue=a(311),De=a.n(Ue),Be=240,Ve=function(e){return{width:Be,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden"}},$e=function(e){return Object(y.a)({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:"calc(".concat(e.spacing(7)," + 1px)")},e.breakpoints.up("sm"),{width:"calc(".concat(e.spacing(9)," + 1px)")})},Ke=Object(C.a)("div")((function(e){var t=e.theme;return Object(w.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:t.spacing(0,1)},t.mixins.toolbar)})),Ge=Object(C.a)(S.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,a=e.open;return Object(w.a)({zIndex:t.zIndex.drawer+1,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},a&&{marginLeft:Be,width:"calc(100% - ".concat(Be,"px)"),transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})})})),Xe=Object(C.a)(I.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,a=e.open;return Object(w.a)(Object(w.a)({width:Be,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},a&&Object(w.a)(Object(w.a)({},Ve(t)),{},{"& .MuiDrawer-paper":Ve(t)})),!a&&Object(w.a)(Object(w.a)({},$e(t)),{},{"& .MuiDrawer-paper":$e(t)}))}));function _e(){var e=Object(E.a)(),t=Object(n.useState)(!1),a=Object(g.a)(t,2),r=a[0],s=a[1],c=Object(m.f)(),o=Object(n.useState)([{icon:Object(p.jsx)(K.a,{}),url:"/dash/users",text:"Usuarios"},{icon:Object(p.jsx)(ze.a,{}),url:"/dash/elections",text:"Eleciones"}]),i=Object(g.a)(o,1)[0],u=function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.a.fire({title:"\xbfEsta seguro que desea salir?",showDenyButton:!0,confirmButtonText:"Si",denyButtonText:"No"});case 2:e.sent.isConfirmed&&(localStorage.clear(),c("/"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(p.jsxs)(k.a,{sx:{flexGrow:1},children:[Object(p.jsx)(F.a,{}),Object(p.jsx)(Ge,{position:"fixed",open:r,children:Object(p.jsxs)(N.a,{children:[Object(p.jsx)(A.a,{color:"inherit","aria-label":"open drawer",onClick:function(){s(!0)},edge:"start",sx:Object(w.a)({marginRight:"36px"},r&&{display:"none"}),children:Object(p.jsx)(T.a,{})}),Object(p.jsx)("div",{className:"ed-grid m-grid-8 s-cross-center",children:Object(p.jsx)("div",{className:"s-ratio-16-9 img-container",children:Object(p.jsx)("img",{src:"https://sabaneta.miproyectoparticipativo.com/img/Lodo_Sabaneta_60x60.png",alt:"aa"})})}),Object(p.jsx)(Le,{}),Object(p.jsx)(A.a,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:u,color:"inherit",children:Object(p.jsx)(De.a,{})})]})}),Object(p.jsxs)(Xe,{className:"from-m",variant:"permanent",open:r,children:[Object(p.jsx)(Ke,{children:Object(p.jsx)(A.a,{onClick:function(){s(!1)},children:"rtl"===e.direction?Object(p.jsx)(U.a,{}):Object(p.jsx)(R.a,{})})}),Object(p.jsx)(q.a,{}),Object(p.jsx)(P.a,{children:i.map((function(e){var t=e.text,a=e.icon,n=e.url;return Object(p.jsx)(b.b,{to:n,children:Object(p.jsxs)(D.a,{children:[Object(p.jsx)(B.a,{children:a}),Object(p.jsx)(V.a,{primary:t})]},t)})}))}),Object(p.jsx)(q.a,{})]}),Object(p.jsx)(k.a,{component:"main",sx:{flexGrow:1,p:3},children:Object(p.jsx)(Ke,{})})]})}var Je=function(e){e.children;return Object(p.jsxs)("div",{className:"ed-item",children:[Object(p.jsxs)("div",{className:"ed-item",children:[" ",Object(p.jsx)(_e,{})]}),Object(p.jsx)("div",{className:"ed-item m-95 s-pb-4 s-to-right",children:Object(p.jsx)(m.b,{})})]})},He=a(650),Qe=a(93),We=a.n(Qe),Ye=a(202),Ze=a.n(Ye),et=a(314),tt=a.n(et),at=a(688),nt=a(667),rt=a(532);Object(G.c)({mixed:{required:"Este campo es requerido"},string:{min:"El minimo de caracteres es de ${min}",max:"El maximo de caracteres es de ${max}",email:"El correo esta mal formateado"},array:{min:"Debe elegir minimo ${min} opci\xf3n",max:"Puede elegir maximo ${max} opciones"}});var st=G.b().shape({name:G.d().required(),email:G.d().email().required(),password:G.d().min(8).max(12).required(),confirPass:G.d().min(8).max(12).required(),roles:G.a().min(1).max(4).required()}).required(),ct=function(){var e=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),O(!0),(n=new FormData).append("images",t.target[0].files[0]),j.defaults.headers.common.authorization=localStorage.getItem("token"),e.next=8,j.post("/auth/register/big",n);case 8:r=e.sent,Z.fire({title:"OK",text:r.data.message,icon:"success"}),setTimeout((function(){return O(!1)}),1e3),a(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),O(!1),ee(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),t=Ct(),a=t.reFreshList,r=t.openCreateModal,s=t.CreateModal,c=t.Rols,o=Object(n.useState)("one"),i=Object(g.a)(o,2),u=i[0],l=i[1],d=Object(n.useState)(!1),b=Object(g.a)(d,2),m=b[0],O=b[1],f=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,O(!0),n=t.password,r=t.confirPass,n===r){e.next=5;break}throw new Error("Sus contrase\xf1as no son inguales");case 5:return t.roles=c.filter((function(e){return t.roles.includes(e.name)})),j.defaults.headers.common.authorization=localStorage.getItem("token"),e.next=9,j.post("/auth/register",t);case 9:s=e.sent,Z.fire({title:"OK",icon:"success",text:s.data.message}),setTimeout((function(){return O(!1)}),1e3),a(),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(0),O(!1),console.error(e.t0),ee(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),h=[{type:"text",name:"name",label:"Nombre",autoFocus:!0,rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(He.a,{})})}},{type:"email",name:"email",label:"Correo",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(We.a,{})})}},{type:"password-see",name:"password",label:"Contrase\xf1a",rules:function(e){return{required:!0}}},{type:"password",name:"confirPass",label:"Repetir Contrase\xf1a",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}},{type:"select-multiple",name:"roles",label:"Roles",currencies:c||[],rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}}];return Object(p.jsxs)(Se,{open:r,onClose:s,children:[Object(p.jsxs)("div",{className:"s-px-1 ed-container",children:[Object(p.jsx)("h2",{className:"s-to-left",children:"one"===u?"Crear Usuario":"Carga masiva de usuarios"}),Object(p.jsx)("div",{className:"s-to-right",children:Object(p.jsxs)(nt.a,{value:u,exclusive:!0,onChange:function(e,t){l(t)},"aria-label":"text alignment",children:[Object(p.jsx)(at.a,{value:"one","aria-label":"left aligned",children:Object(p.jsx)(Fe.a,{title:"Formulario",placement:"top-start",children:Object(p.jsx)(Ze.a,{})})}),Object(p.jsx)(at.a,{value:"big","aria-label":"right",children:Object(p.jsx)(Fe.a,{title:"Carga Masiva",placement:"top-end",children:Object(p.jsx)(tt.a,{})})})]})})]}),"one"===u?Object(p.jsx)(Ae,{load:m,children:Object(p.jsx)(ke,{Action:f,schema:st,fromInput:h,buttonText:"Crear"})}):Object(p.jsx)("div",{className:"ed-item s-pt-3",children:Object(p.jsxs)(Ae,{load:m,children:[Object(p.jsxs)("form",{className:"ed-grid m-grid-2",onSubmit:e,children:[Object(p.jsxs)(rt.a,{htmlFor:"upload-photo",variant:"contained",component:"label","aria-label":"add",children:[Object(p.jsx)("input",{style:{display:"none"},id:"upload-photo",name:"upload-photo",type:"file"}),Object(p.jsx)(Ze.a,{})," Archivo"]}),Object(p.jsx)(rt.a,{type:"submit",variant:"contained",children:"Enviar"}),Object(p.jsx)("br",{}),Object(p.jsxs)(rt.a,{href:"https://docs.google.com/spreadsheets/d/1lXnGUK57SXQvSfOSWFr5BdXhgr-1P0tK/edit?usp=sharing&ouid=104417394668609533492&rtpof=true&sd=true",target:"_blank",className:"m-cols-2 ",variant:"contained",component:"a","aria-label":"add",children:[Object(p.jsx)(Ze.a,{})," Planilla de carga masiva"]})]})," "]})})]})},ot=G.b().shape({name:G.d(),email:G.d().email(),roles:G.a().min(1).max(4)}),it=function(){var e=Ct(),t=e.reFreshList,a=e.openEditModal,r=e.EditModal,s=e.Rols,c=e.User,o=Object(n.useState)(!1),i=Object(g.a)(o,2),u=i[0],l=i[1],d=function(){var e=Object(v.a)(x.a.mark((function e(a){var n,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(!0),n=Object.fromEntries(Object.entries(a).filter((function(e){var t=Object(g.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];return"roles"===n?[n,s.filter((function(e){return a.roles.includes(e.name)}))]:[n,r]}))),j.defaults.headers.common.authorization=localStorage.getItem("token"),e.next=6,j.put("/users/"+c.id,n);case 6:o=e.sent,Z.fire({title:"OK",text:o.data.message,icon:"success"}),setTimeout((function(){r(),l(!1)}),1e3),t(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),l(!1),Z.fire({title:"Error",text:e.t0,icon:"error"});case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),b=Object(n.useState)([{type:"text",name:"name",label:"Nombre",autoFocus:!0,rules:function(e){return{required:!1}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(He.a,{})})}},{type:"email",name:"email",label:"Correo",rules:function(e){return{required:!1}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(We.a,{})})}},{type:"select-multiple",name:"roles",label:"Roles",currencies:s||[],checkItems:[],rules:function(e){return{required:!1}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}}]),m=Object(g.a)(b,2),O=m[0],f=m[1];return Object(n.useLayoutEffect)((function(){if(c){var e=O;Object.entries(c).forEach((function(t){var a=Object(g.a)(t,2),n=a[0],r=a[1],s=e.findIndex((function(e){return e.name===n}));-1!==s&&"roles"!==n&&(e[s].value=r),"roles"===n&&(e[s].checkItems=r.map((function(e){return e.name})))})),f(e)}}),[O,c]),Object(n.useLayoutEffect)((function(){var e=O;e[2].currencies=s,f(e)}),[O,s]),Object(p.jsxs)(Se,{open:a,onClose:r,children:[Object(p.jsx)("h2",{className:"s-center",children:"Editar Usuario"}),Object(p.jsx)(Ae,{load:u,children:Object(p.jsx)(Me,{Action:d,schema:ot,fromInput:O,buttonText:"editar"})})]})},ut=a(317),lt=a.n(ut),dt=a(316),jt=a.n(dt),bt=a(315),mt=a.n(bt),pt=a(161),Ot=a(671),ft=function(){var e=pt.c.components;if(e){var t=e.MuiDataGrid;if(t){var a=t.defaultProps;if(a){var n=a.localeText;if(n)return n}}}},ht=function(e){var t=e.rows,a=e.columns,r=e.actions,s=Object(n.useState)([]),c=Object(g.a)(s,2),o=c[0],i=c[1];return Object(n.useLayoutEffect)((function(){var e=t.map((function(e){var t=Object.entries(e).map((function(e){var t=Object(g.a)(e,2),a=t[0],n=t[1];if("object"!==typeof n)return[a,n];if(!Array.isArray(n))return[a,n.name];var r=n.map((function(e){return e.name})).join(", ");return[a,r]}));return Object.fromEntries(t)}));i(e)}),[t]),Object(p.jsx)("div",{style:{height:300,width:"100%"},children:Object(p.jsx)(pt.a,{localeText:ft(),rows:o,columns:function(e,t){if(!t)return e;var a=function(e){var t=e.remove,a=e.print,n=e.edit;return{field:"actions",headerName:"Acciones",width:150,renderCell:function(e){var r=e.row;return Object(p.jsxs)("strong",{children:[a?Object(p.jsx)(Ot.a,{size:"small",onClick:function(){return a(r)},color:"inherit",children:Object(p.jsx)(mt.a,{})}):"",n?Object(p.jsx)(Ot.a,{size:"small",onClick:function(){return n(r)},color:"primary",children:Object(p.jsx)(jt.a,{})}):"",t?Object(p.jsx)(Ot.a,{size:"small",onClick:function(){return t(r)},color:"secondary",children:Object(p.jsx)(lt.a,{})}):""]})}}}(t);return e.concat(a)}(a,r)})})},xt=function(){var e=Ct(),t=e.NewUser,a=e.defineUser,r=e.Rols,s=e.EditModal,c=Object(i.b)({url:"/users",method:"GET",headers:{common:{authorization:localStorage.getItem("token")}}}),u=Object(g.a)(c,1)[0].data,l=Object(n.useState)([{id:"",name:"",email:"",roles:[{name:""}]}]),d=Object(g.a)(l,2),j=d[0],b=d[1];Object(n.useLayoutEffect)((function(){u&&u.info&&!t?b(u.info):o.a.get("/users").then((function(e){var t=e.data;t.info&&b(t.info)}))}),[t,u]);var m={edit:function(e){var t=r.filter((function(t){return e.roles.includes(t.name)})),n=Object(w.a)(Object(w.a)({},e),{},{roles:t});a(n),s()}};return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(ht,{rows:j,columns:[{field:"id",headerName:"ID",width:120},{field:"name",headerName:"Nombre",width:170},{field:"email",headerName:"Email",width:170},{field:"roles",headerName:"Roles",width:170}],actions:m})})},vt=a(194),gt=a.n(vt),wt={NewUser:0,openCreateModal:!1,openEditModal:!1,UserData:{},reFreshList:function(){},CreateModal:function(){},EditModal:function(){},defineUser:function(){},Rols:[],User:{}},yt=Object(n.createContext)(wt),Ct=function(){return Object(n.useContext)(yt)},Et="ReFreshList",kt="Roles",It="User",St=function(e,t){var a=t.payload,n=t.type;return n===Et?(e.NewUser=e.NewUser+1,e):n===kt?(e.Rols=a,e):n===It?(e.User=a,e):void 0},Nt=function(){var e=Object(i.b)("/roles"),t=Object(g.a)(e,2),a=t[0].data,r=t[1],s=Object(n.useReducer)(St,wt),c=Object(g.a)(s,2),o=c[0],u=c[1],l=Object(n.useState)(0),d=Object(g.a)(l,2),j=d[0],b=d[1],m=Object(n.useState)(!1),O=Object(g.a)(m,2),f=O[0],h=O[1],x=Object(n.useState)(!1),v=Object(g.a)(x,2),y=v[0],C=v[1],E=function(){return C(!y)};return Object(n.useLayoutEffect)((function(){a?(u({type:kt,payload:a.info}),b(j+1)):r()}),[a]),Object(p.jsxs)(yt.Provider,{value:Object(w.a)(Object(w.a)({},o),{},{openCreateModal:y,reFreshList:function(){u({type:Et}),b(j+1)},CreateModal:E,defineUser:function(e){u({type:It,payload:e})},EditModal:function(){return h(!f)},openEditModal:f}),children:[Object(p.jsxs)("div",{className:"ed-container s-py-5",children:[Object(p.jsxs)("div",{className:"ed-item",children:[Object(p.jsx)("h2",{children:"Lista de usuarios"}),Object(p.jsx)(xt,{})]}),Object(p.jsx)(ct,{}),Object(p.jsx)(it,{})]}),Object(p.jsx)(k.a,{sx:{position:"fixed",width:60,height:60,bottom:40,right:40},children:Object(p.jsx)(Ot.a,{onClick:E,color:"primary","aria-label":"add",children:Object(p.jsx)(gt.a,{})})})]})},Pt=G.b({name:G.d().required()}).required(),Ft=function(){var e=Rt(),t=e.reFreshList,a=e.openCreateModal,r=e.CreateModal,s=Object(n.useState)(!1),c=Object(g.a)(s,2),o=c[0],i=c[1],u=function(){var e=Object(v.a)(x.a.mark((function e(a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(!0),e.next=4,j.post("/elections",a);case 4:Z.fire({title:"OK",text:"Elecci\xf3n Creada",icon:"success"}),setTimeout((function(){return i(!1)}),1e3),t(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),i(!1),ee(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),l=[{type:"text",name:"name",label:"Nombre",autoFocus:!0,rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(He.a,{})})}}],d={Action:u,schema:Pt,fromInput:l,buttonText:"Crear"};return Object(p.jsxs)(Se,{open:a,onClose:r,children:[Object(p.jsx)("h2",{className:"s-center",children:"Crear Elecci\xf3n"}),Object(p.jsx)(Ae,{load:o,children:Object(p.jsx)(Me,Object(w.a)({},d))})]})},qt=G.b().shape({name:G.d(),status:G.d()}),At=function(){var e=Rt(),t=e.reFreshList,a=e.openEditModal,r=e.EditModal,s=e.status,c=e.Election,o=Object(n.useState)(!1),i=Object(g.a)(o,2),u=i[0],l=i[1],d=function(){var e=Object(v.a)(x.a.mark((function e(a){var n,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l(!0),n=Object.fromEntries(Object.entries(a).filter((function(e){var t=Object(g.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];return"status"===n?[n,s.find((function(e){return a.status===e.name})).id]:[n,r]}))),Object.keys(n).length){e.next=5;break}throw new Error("No se puede actualizar una elecci\xf3n sin cambios");case 5:return j.defaults.headers.common.authorization=localStorage.getItem("token"),e.next=8,j.put("/elections/"+c.id,n);case 8:o=e.sent,Z.fire({title:"OK",text:o.data.message,icon:"success"}),setTimeout((function(){r(),l(!1)}),1e3),t(),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(0),l(!1),console.error(e.t0),ee(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),b=Object(n.useState)([{type:"text",name:"name",label:"Nombre",autoFocus:!0,rules:function(e){return{required:!1}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(He.a,{})})}},{type:"select",name:"status",label:"Status",currencies:s||[],rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}}]),m=Object(g.a)(b,2),O=m[0],f=m[1];return Object(n.useLayoutEffect)((function(){if(c){var e=O;Object.entries(c).forEach((function(t){var a=Object(g.a)(t,2),n=a[0],r=a[1],s=e.findIndex((function(e){return e.name===n}));-1!==s&&(e[s].value=r)})),s&&(e[1].currencies=s),f(e)}}),[O,c,s]),Object(p.jsxs)(Se,{open:a,onClose:r,children:[Object(p.jsx)("h2",{className:"s-center",children:"Editar Elecci\xf3n"}),Object(p.jsx)(Ae,{load:u,children:Object(p.jsx)(Me,{Action:d,schema:qt,fromInput:O,buttonText:"editar"})})]})},Mt=function(){var e=Rt(),t=e.NewElection,a=e.defineElection,r=e.EditModal,s=Object(i.b)({url:"/elections",method:"GET",headers:{common:{authorization:localStorage.getItem("token")}}}),c=Object(g.a)(s,1)[0].data,u=Object(n.useState)([{id:"",name:"",status:{id:"",name:""}}]),l=Object(g.a)(u,2),d=l[0],j=l[1];Object(n.useLayoutEffect)((function(){c&&c.info&&!t?j(c.info):o.a.get("/elections").then((function(e){var t=e.data;t.info&&j(t.info)}))}),[t,c]);var b={edit:function(e){a(e),r()}};return Object(p.jsx)(ht,{rows:d,columns:[{field:"id",headerName:"ID",width:120},{field:"name",headerName:"Nombre",width:170},{field:"status",headerName:"Estado",width:150}],actions:b})},Tt={NewElection:0,openCreateModal:!1,openEditModal:!1,ElectionData:{},reFreshList:function(){},CreateModal:function(){},EditModal:function(){},defineElection:function(){},status:[],Election:{}},Lt=Object(n.createContext)(Tt),Rt=function(){return Object(n.useContext)(Lt)},zt="ReFreshList",Ut="Status",Dt="Election",Bt=function(e,t){var a=t.payload,n=t.type;return n===zt?(e.NewElection=e.NewElection+1,e):n===Ut?(e.status=a,e):n===Dt?(e.Election=a,e):void 0},Vt=function(){var e=Object(i.b)("/elections/status"),t=Object(g.a)(e,2),a=t[0].data,r=t[1],s=Object(n.useReducer)(Bt,Tt),c=Object(g.a)(s,2),o=c[0],u=c[1],l=Object(n.useState)(0),d=Object(g.a)(l,2),j=d[0],b=d[1],m=Object(n.useState)(!1),O=Object(g.a)(m,2),f=O[0],h=O[1],x=Object(n.useState)(!1),v=Object(g.a)(x,2),y=v[0],C=v[1],E=function(){return C(!y)};return Object(n.useLayoutEffect)((function(){a?(u({type:Ut,payload:a.info}),b(j+1)):r()}),[a]),Object(p.jsxs)(Lt.Provider,{value:Object(w.a)(Object(w.a)({},o),{},{openCreateModal:y,reFreshList:function(){u({type:zt}),b(j+1)},CreateModal:E,defineElection:function(e){u({type:Dt,payload:e})},EditModal:function(){return h(!f)},openEditModal:f}),children:[Object(p.jsxs)("div",{className:"ed-container s-py-5",children:[Object(p.jsxs)("div",{className:"ed-item",children:[Object(p.jsx)("h2",{children:"Lista de Elecciones"}),Object(p.jsx)(Mt,{})]}),Object(p.jsx)(Ft,{}),Object(p.jsx)(At,{})]}),Object(p.jsx)(k.a,{sx:{position:"fixed",width:60,height:60,bottom:40,right:40},children:Object(p.jsx)(Ot.a,{onClick:E,color:"primary","aria-label":"add",children:Object(p.jsx)(gt.a,{})})})]})},$t=function(){var e=[{path:"/dash",element:Object(p.jsx)(Je,{}),children:[{index:!0,element:Object(p.jsx)(Nt,{})},{path:"/dash/users",element:Object(p.jsx)(Nt,{})},{path:"/dash/elections",element:Object(p.jsx)(Vt,{})}]}];return Object(m.h)(e)},Kt=a(152),Gt=a(674),Xt=function(){var e=Object(m.e)().pathname;return Object(p.jsx)("div",{className:"m-50 s-to-center s-pt-3",children:Object(p.jsx)(k.a,{children:Object(p.jsxs)(Gt.a,{className:"m-px-2",variant:"outlined",children:[Object(p.jsx)("div",{className:"ed-grid m-grid-4 s-cross-center",children:Object(p.jsx)("div",{className:"s-ratio-4-3 m-cols-2 m-x-2 img-container",children:Object(p.jsx)("img",{src:"img/Lodo_Sabaneta_60x60.png",alt:"aa"})})}),Object(p.jsx)(m.b,{}),Object(p.jsx)("div",{className:"s-right s-py-1",children:"/"===e?Object(p.jsx)(b.b,{to:"/pass",children:Object(p.jsx)(Kt.a,{children:"\xbfOlvid\xf3 su contrase\xf1a?"})}):Object(p.jsx)(b.b,{to:"/",children:Object(p.jsx)(Kt.a,{children:"Iniciar Sesi\xf3n"})})})]})})})},_t=Object(n.createContext)({auth:!1,saveAuth:{}}),Jt="AUTH",Ht=function(e,t){t.payload;if(t.type===Jt)return e.auth=!!localStorage.getItem("token"),e},Qt=function(e){var t=e.children,a={login:function(e){localStorage.setItem("token",e),i({type:Jt})},logout:function(){localStorage.removeItem("token"),i({type:Jt})}},r={auth:!!localStorage.getItem("token"),saveAuth:a},s=Object(n.useReducer)(Ht,r),c=Object(g.a)(s,2),o=c[0],i=c[1];return Object(p.jsx)(_t.Provider,{value:Object(w.a)(Object(w.a)({},o),{},{saveAuth:a}),children:t})};Object(G.c)({mixed:{required:"Este campo es requerido"},string:{min:"El minimo de caracteres es de ${min}",max:"El maximo de caracteres es de ${max}",email:"El correo esta mal formateado"}});var Wt=G.b().shape({email:G.d().email().required(),password:G.d().required()}),Yt=function(){var e=Object(n.useContext)(_t).saveAuth,t=Object(m.f)(),a=Object(n.useState)(!1),r=Object(g.a)(a,2),s=r[0],c=r[1],o=function(){var a=Object(v.a)(x.a.mark((function a(n){var r,s;return x.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!((r=n.password).length<8||r.length>12)){a.next=4;break}throw new Error("La contrase\xf1a es incorrecta");case 4:return c(!0),j.defaults.headers.common.authorization=localStorage.getItem("token"),a.next=8,j.post("/auth/login",n);case 8:if(s=a.sent,s.data.info.roles.find((function(e){return"Admin"===e.name}))){a.next=12;break}throw new Error("No tiene permisos para acceder");case 12:localStorage.setItem("token",s.data.token),setTimeout((function(){return c(!1)}),1e3),e.login(s.data.token),window.location.reload(),t("/dash/users"),a.next=24;break;case 19:a.prev=19,a.t0=a.catch(0),c(!1),localStorage.clear(),ee(a.t0);case 24:case"end":return a.stop()}}),a,null,[[0,19]])})));return function(e){return a.apply(this,arguments)}}(),i=[{type:"text",name:"email",label:"Correo",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(We.a,{})})}},{type:"password",name:"password",label:"Contrase\xf1a",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}}];return Object(p.jsx)(Ae,{load:s,children:Object(p.jsx)(ke,{buttonText:"Entrar",Action:o,schema:Wt,fromInput:i})})},Zt=G.b({name:G.d().required(),email:G.d().required(),password:G.d().required(),confirPass:G.d().required()}).required(),ea=function(){var e=function(){var e=Object(v.a)(x.a.mark((function e(t){var a,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.password,n=t.confirPass,a===n){e.next=4;break}throw{title:"Error",text:"Sus contrase\xf1as no son inguales",icon:"error"};case 4:return e.next=6,j.post("/auth/register",t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),Z.fire(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),t=[{type:"text",name:"name",label:"Nombre",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(He.a,{})})}},{type:"email",name:"email",label:"Correo",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(We.a,{})})}},{type:"password-see",name:"password",label:"Contrase\xf1a",rules:function(e){return{required:!0}}},{type:"password",name:"confirPass",label:"Repetir Contrase\xf1a",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(J.a,{})})}}];return Object(p.jsx)(ke,{buttonText:"crear",Action:e,schema:Zt,fromInput:t})};Object(G.c)({mixed:{required:"Este campo es requerido"}});var ta=G.b().shape({email:G.d().email().required()}).required(),aa=function(){var e=Object(m.f)(),t=Object(n.useState)(!1),a=Object(g.a)(t,2),r=a[0],s=a[1],c=function(){var t=Object(v.a)(x.a.mark((function t(a){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s(!0),t.next=4,j.post("/auth/newPassEmail",a);case 4:Z.fire({title:"Revise su correo",icon:"success"}),setTimeout((function(){s(!1),e("/")}),1e3),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),s(!1),localStorage.clear(),ee(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),o=[{type:"text",name:"email",label:"Correo",rules:function(e){return{required:!0}},InputProps:{startAdornment:Object(p.jsx)(X.a,{position:"start",children:Object(p.jsx)(We.a,{})})}}];return Object(p.jsx)(Ae,{load:r,children:Object(p.jsx)(ke,{buttonText:"Enviar",Action:c,schema:ta,fromInput:o})})},na=function(e){var t=e.type;return"login"===t?Object(p.jsx)(Yt,{}):"MailPass"===t?Object(p.jsx)(aa,{}):Object(p.jsx)(ea,{})},ra=function(){var e=[{path:"/",element:Object(p.jsx)(Xt,{}),children:[{index:!0,element:Object(p.jsx)(na,{type:"login"})},{path:"/pass",element:Object(p.jsx)(na,{type:"MailPass"})}]}];return Object(m.h)(e)},sa=function(){return Object(p.jsxs)(Qt,{children:[" ",Object(p.jsxs)(b.a,{children:[Object(p.jsx)(f,{children:Object(p.jsx)(ra,{})}),Object(p.jsxs)(O,{children:[" ",Object(p.jsx)($t,{})]})]})]})},ca=a(320),oa=a(661),ia=a(319);a(505);var ua=function(){var e=Object(E.a)(),t=Object(ca.a)(e,pt.b,ia.a);return Object(p.jsx)("div",{className:"ed-container",children:Object(p.jsx)(oa.a,{theme:t,children:Object(p.jsx)(sa,{})})})},la=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,689)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))},da=a(506);s.a.render(Object(p.jsx)(da.a,{injectFirst:!0,children:Object(p.jsx)(ua,{})}),document.getElementById("root")),la()}},[[507,1,2]]]);
//# sourceMappingURL=main.7ae2dd4b.chunk.js.map